<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Krishna Chemudupati - Electrical Engineer & Device Physics Researcher at UPenn. Specializing in semiconductor devices, autonomous systems, and machine learning.">
    <meta name="author" content="Krishna Chemudupati">
    <title>Krishna Chemudupati | Electrical Engineer & Researcher</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <canvas id="bgCanvas"></canvas>

    <!-- Navigation -->
    <header role="banner">
        <nav aria-label="Main navigation">
            <div class="logo">KC</div>
            <ul class="nav-links">
                <li><a href="#about">About</a></li>
                <li><a href="#skills">Skills</a></li>
                <li><a href="#experience">Experience</a></li>
                <li><a href="#projects">Projects</a></li>
                <li><a href="#blog">Blog</a></li>
                <li><a href="#contact">Contact</a></li>
                <li><a href="admin-firebase.html" class="admin-link">Admin</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-grid">
            <div class="hero-card">
                <h1 class="hero-name">Krishna Chemudupati</h1>
                <p class="hero-title">Electrical Engineer & Device Physics Researcher</p>
                <p class="hero-bio">
                    MSE student at UPenn working on semiconductor memory, autonomous systems, and the intersection of hardware and ML.
                </p>
                <div class="hero-buttons">
                    <a href="#projects" class="pill-btn">Projects</a>
                    <a href="#contact" class="pill-btn">Contact</a>
                    <a href="#blog" class="pill-btn">Blog</a>
                </div>
            </div>
            <div class="hero-image">
                <div class="identity-placeholder">
                    <span class="identity-initials">KC</span>
                </div>
                <p class="hero-tagline">"Bridging quantum and classical computing"</p>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about">
        <div class="container">
            <h2>About Me</h2>
            <div class="about-grid">
                <div class="profile-img" aria-label="Profile">KC</div>
                <div class="about-text" id="aboutContent">
                    <p style="color: var(--text-muted);">Loading...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Skills Section -->
    <section id="skills">
        <div class="container">
            <h2>Technical Skills</h2>
            <div class="skills-grid" id="skillsContent">
                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">Loading...</p>
            </div>
        </div>
    </section>

    <!-- Experience Section -->
    <section id="experience">
        <div class="container">
            <h2>Research Experience</h2>
            <div class="timeline" id="experienceContent">
                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">Loading...</p>
            </div>
        </div>
    </section>

    <!-- Projects Section -->
    <section id="projects">
        <div class="container">
            <h2>Featured Projects</h2>
            <div class="projects-grid" id="projectsContent">
                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">Loading...</p>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog">
        <div class="container">
            <h2>Recent Writing</h2>
            <div class="blog-grid" id="blogContainer">
                <!-- Blog posts will be loaded from Firebase -->
                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">
                    Loading posts...
                </p>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact">
        <div class="container">
            <h2>Get in Touch</h2>
            <p style="color: var(--text-muted); margin-bottom: 2rem; max-width: 600px;">
                I'm always interested in discussing research opportunities, collaborations, or just
                chatting about hardware, software, and everything in between.
            </p>
            <div class="contact-grid">
                <a href="mailto:krishkc@seas.upenn.edu" class="contact-link" aria-label="Email Krishna">
                    <div class="icon">ðŸ“§</div>
                    <span>Email</span>
                </a>
                <a href="tel:+14078087141" class="contact-link" aria-label="Call Krishna">
                    <div class="icon">ðŸ“±</div>
                    <span>Phone</span>
                </a>
                <a href="https://linkedin.com" target="_blank" rel="noopener noreferrer" class="contact-link" aria-label="LinkedIn Profile">
                    <div class="icon">ðŸ’¼</div>
                    <span>LinkedIn</span>
                </a>
                <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="contact-link" aria-label="GitHub Profile">
                    <div class="icon">ðŸ’»</div>
                    <span>GitHub</span>
                </a>
            </div>
        </div>
    </section>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Config -->
    <script src="firebase-config.js"></script>

    <!-- Content Loader -->
    <script src="content-loader.js"></script>

    <script src="script.js"></script>
    <script>
        // Initialize content loader
        const contentLoader = new ContentLoader();

        // Load content from markdown files
        document.addEventListener('DOMContentLoaded', async () => {
            // Load About section
            try {
                const aboutItems = await contentLoader.loadFolder('content/about');
                const aboutContainer = document.getElementById('aboutContent');
                if (aboutItems.length > 0) {
                    aboutContainer.innerHTML = aboutItems
                        .map(item => item.content)
                        .join('');
                } else {
                    aboutContainer.innerHTML = '<p>Content coming soon...</p>';
                }
            } catch (error) {
                console.error('Error loading about content:', error);
            }

            // Load Skills section
            try {
                const skillItems = await contentLoader.loadFolder('content/skills');
                const skillsContainer = document.getElementById('skillsContent');
                if (skillItems.length > 0) {
                    skillsContainer.innerHTML = skillItems
                        .sort((a, b) => (a.order || 999) - (b.order || 999))
                        .map(item => {
                            const skillList = item.skills || item.items || [];
                            return `
                            <div class="skill-card">
                                <h3>${escapeHtml(item.title || 'Skills')}</h3>
                                <div class="skill-tags">
                                    ${Array.isArray(skillList) ? skillList.map(skill =>
                                        `<span class="skill-tag">${escapeHtml(skill)}</span>`
                                    ).join('') : ''}
                                </div>
                            </div>
                        `;
                        }).join('');
                } else {
                    skillsContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">Content coming soon...</p>';
                }
            } catch (error) {
                console.error('Error loading skills content:', error);
            }

            // Load Experience section
            try {
                const experienceItems = await contentLoader.loadFolder('content/experience');
                const experienceContainer = document.getElementById('experienceContent');
                if (experienceItems.length > 0) {
                    experienceContainer.innerHTML = experienceItems
                        .sort((a, b) => (a.order || 999) - (b.order || 999))
                        .map(item => `
                            <div class="timeline-item">
                                <h3>${escapeHtml(item.title || 'Position')}</h3>
                                <div class="company">${escapeHtml(item.company || '')}</div>
                                <div class="date">${escapeHtml(item.date || '')}</div>
                                ${item.content}
                            </div>
                        `).join('');
                } else {
                    experienceContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">Content coming soon...</p>';
                }
            } catch (error) {
                console.error('Error loading experience content:', error);
            }

            // Load Projects section
            try {
                const projectItems = await contentLoader.loadFolder('content/projects');
                const projectsContainer = document.getElementById('projectsContent');
                if (projectItems.length > 0) {
                    projectsContainer.innerHTML = projectItems
                        .sort((a, b) => (a.order || 999) - (b.order || 999))
                        .map(item => `
                            <article class="project-card">
                                <h3>${escapeHtml(item.title || 'Project')}</h3>
                                ${item.content}
                                ${item.tags && item.tags.length > 0 ? `
                                    <div class="tech-tags">
                                        ${item.tags.map(tag =>
                                            `<span class="tech-tag">${escapeHtml(tag)}</span>`
                                        ).join('')}
                                    </div>
                                ` : ''}
                            </article>
                        `).join('');
                } else {
                    projectsContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">Content coming soon...</p>';
                }
            } catch (error) {
                console.error('Error loading projects content:', error);
            }

            loadBlogPosts();
        });

        // Load blog posts from Firebase
        async function loadBlogPosts() {
            const blogContainer = document.getElementById('blogContainer');

            // Check if Firebase is loaded
            if (typeof firebase === 'undefined' || typeof db === 'undefined') {
                console.error('Firebase not loaded');
                blogContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">Blog posts temporarily unavailable.</p>';
                return;
            }

            try {
                const snapshot = await db.collection('posts')
                    .where('published', '==', true)
                    .orderBy('createdAt', 'desc')
                    .limit(6)
                    .get();

                const posts = [];
                snapshot.forEach(doc => posts.push({ id: doc.id, ...doc.data() }));

                if (posts && posts.length > 0) {
                    blogContainer.innerHTML = posts.map(post => `
                        <a href="post.html?id=${post.id}" class="blog-card-link">
                            <article class="blog-card">
                                <div class="date">${post.createdAt ? new Date(post.createdAt.toDate()).toLocaleDateString('en-US', {
                                    year: 'numeric',
                                    month: 'long',
                                    day: 'numeric'
                                }) : 'Recent'}</div>
                                <h3>${escapeHtml(post.title || 'Untitled')}</h3>
                                ${post.tags && post.tags.length > 0 ? `
                                <div class="blog-tags">
                                    ${post.tags.map(tag => `<span class="blog-tag">${escapeHtml(tag)}</span>`).join('')}
                                </div>
                                ` : ''}
                                <p class="excerpt">${escapeHtml(post.excerpt || 'No excerpt available')}</p>
                            </article>
                        </a>
                    `).join('');
                } else {
                    blogContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">No blog posts yet. Check back soon!</p>';
                }
            } catch (error) {
                console.error('Error loading blog posts:', error);
                blogContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">Unable to load posts. Please try again later.</p>';
            }
        }

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
